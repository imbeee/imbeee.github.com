<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="A blog containing some interesting things."><title>Beeeの零碎事 | Just so so~</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Beeeの零碎事</h1><a id="logo" href="/.">Beeeの零碎事</a><p class="description">Just so so~</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title"><a href="/2019/09/01/unload-built-in-m25p80-driver/">卸载编译到内核中的m25p80驱动</a></h1><div class="post-meta">2019-09-01</div><div class="post-content"><p>最近在测试某些嵌入式设备，在研究过程中需要在系统启动后替换m25p80驱动以达到特定效果。而该设备固件将m25p80直接编译到内核中，并非以LKM的形式存在，无法使用rmmod卸载。</p>
<p>查阅资料后发现,内核在处理spi相关驱动的时候，使用<code>spi_register_driver</code>函数注册m25p80驱动，并且提供<code>spi_unregister_driver</code>函数用于卸载驱动。进一步查看这两个函数的定义，可以发现主要参数都是一个<code>spi_driver</code>结构体。</p></div><p class="readmore"><a href="/2019/09/01/unload-built-in-m25p80-driver/">Read More</a></p></div><div class="post"><h1 class="post-title"><a href="/2019/01/21/awvs-script-decrypt/">awvs脚本解密工具</a></h1><div class="post-meta">2019-01-21</div><div class="post-content"><p>2017年年底研究wvs脚本的时候将相关的程序逆了一下，把加密密钥搞出来了，用的twofish算法。当时也准备把分析的过程完整的记录一下，后面因为各种事情忙而搁置了，现在很多细节也记不清楚，只能直接把程序发上来了。</p>
<p>因为能找到的twofish算法python库解密结果都不对，所以偷懒直接用delhpi写了，用的是原程序同款的DCPcrypt2库来操作twofish，有需要的同学自行下载。<br><img src="https://ws1.sinaimg.cn/large/006tNc79ly1fzedxjfplfj316a0ns41q.jpg" alt=""></p></div><p class="readmore"><a href="/2019/01/21/awvs-script-decrypt/">Read More</a></p></div><div class="post"><h1 class="post-title"><a href="/2018/11/01/yet-another-php-backdoor-with-nginx-phpfpm/">php-fpm环境的一种后门实现</a></h1><div class="post-meta">2018-11-01</div><div class="post-content"><p>之前发到安全客上的一篇文章，同步到博客来。</p>
<hr>
<p>目前常见的php后门基本需要文件来维持（常规php脚本后门：一句话、大马等各种变形；WebServer模块：apache扩展等，需要高权限并且需要重启WebServer），或者是脚本运行后删除自身，利用死循环驻留在内存里，不断主动外连获取指令并且执行。两者都无法做到无需高权限、无需重启WeServer、触发后删除脚本自身并驻留内存、无外部进程、能主动发送控制指令触发后门（避免内网无法外连的情况）。</p></div><p class="readmore"><a href="/2018/11/01/yet-another-php-backdoor-with-nginx-phpfpm/">Read More</a></p></div><div class="post"><h1 class="post-title"><a href="/2017/12/24/full-functional-reverse-shell/">linux反弹完全交互shell</a></h1><div class="post-meta">2017-12-24</div><div class="post-content"><p>在渗透测试中经常需要用到反弹shell，而一般反弹回来的shell通常无法完成某些交互操作，如vi编辑文件等。这里先占个坑，简单把反弹一个完全交互shell的过程写出来，回头有机会再补充分析。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 本地监听</span><br><span class="line">stty -a         //获取当前终端参数备用</span><br><span class="line">stty raw        //设置当前终端为raw模式，部分发行版还需要加上-echo关闭终端回显</span><br><span class="line">nc -vlp 1234    //监听端口，此时当前终端无回显，盲打或将上述命令做成shell脚本</span><br></pre></td></tr></table></figure></div><p class="readmore"><a href="/2017/12/24/full-functional-reverse-shell/">Read More</a></p></div><div class="post"><h1 class="post-title"><a href="/2017/12/16/Proxmox-VE-Homelab/">Proxmox VE搭建Homelab实验环境</a></h1><div class="post-meta">2017-12-16</div><div class="post-content"><p>最近经常需要搭建实验环境做测试，重复的系统部署工作无疑是枯燥的体力活。DarkRay大师先前也分享过基于ESXi虚拟化的Homelab方案，详见<a href="https://www.blackh4t.org/2017/12/14/all-about-virtualization/" target="_blank" rel="noopener">穷人的虚拟化实验室方案</a>。这里记录一下我用Proxmox VE搭建实验环境的过程。</p></div><p class="readmore"><a href="/2017/12/16/Proxmox-VE-Homelab/">Read More</a></p></div><div class="post"><h1 class="post-title"><a href="/2017/12/10/install-pure-system-on-vps-and-encrypt-it/">给vps挂载iso安装系统并加密系统分区</a></h1><div class="post-meta">2017-12-10</div><div class="post-content"><p>部分VPS提供商的控制面板仅提供简单的重装系统功能，只能从其提供的有限的iso中选择安装，并且无法验证iso的完整性，或者根本不提供iso挂载功能，直接使用模板重置vps。因此我们无法安装自己所需的系统和对vps系统进行全盘加密。这篇文章简单记录一下如何在vps上挂载自定义iso安装系统并进行加密。</p></div><p class="readmore"><a href="/2017/12/10/install-pure-system-on-vps-and-encrypt-it/">Read More</a></p></div><div class="post"><h1 class="post-title"><a href="/2016/01/11/ISG2015-RPG-400-Writeup/">ISG2015-RPG-400-Writeup</a></h1><div class="post-meta">2016-01-11</div><div class="post-content"><p>该题是由rpgmakerxp做的一个小迷宫。解压后一看，根目录下有个<code>config.txt</code>，里面为<code>202.120.7.132:9999</code>，初步判断游戏跟服务器有交互。运行游戏，方向键移动角色，wireshark确实能抓取到与服务器交互的数据。<br>用rpgmakerxp编辑该游戏的方法是：用rpgmakerxp新建一个游戏，保存，把游戏目录下的<code>Game.rxproj</code>复制到RPG目录里，再用rpgmakerxp打开该文件即可。<br>打开后，可以看到迷宫尺寸为499*499。同时在rpgmakerxp中，下标起始为0，用二元组表示为（列，行）。角色起始坐标在（1，1），宝箱在（497，497）。题目描述为打开宝箱即得flag。<br>从rpgmakerxp的工具菜单里打开脚本编辑器，拖到最下面看<code>Main</code>脚本，其中有这样的一段：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">host, port = File.new(&quot;config.txt&quot;, &quot;r&quot;).readline().strip().split(&quot;:&quot;)</span><br><span class="line">$CONN = TCPClient.new(host, port.to_i)</span><br><span class="line">$CONN.connect()</span><br></pre></td></tr></table></figure></p></div><p class="readmore"><a href="/2016/01/11/ISG2015-RPG-400-Writeup/">Read More</a></p></div><div class="post"><h1 class="post-title"><a href="/2016/01/06/reGeorgSocksProxy-with-single-session-mode/">reGeorgSocksProxy修改版-可指定Cookie</a></h1><div class="post-meta">2016-01-06</div><div class="post-content"><p>reGeorgSocksProxy是一款渗透测试中常用到的http2socks隧道，本文简单介绍reGeorgSocksProxy的工作原理以及我在使用过程中遇到的小问题，并给出我的修改方法及最终修改后的代码。</p>
<h3 id="reGeorgSocksProxy工作原理"><a href="#reGeorgSocksProxy工作原理" class="headerlink" title="reGeorgSocksProxy工作原理"></a>reGeorgSocksProxy工作原理</h3><p>reGeorgSocksProxy由服务端和客户端两部分组成。服务端有php、aspx、asph、jsp、node.js等多个版本，客户端则由python编写。其工作原理可简单描述为python客户端在本地监听一个端口，提供socks服务，并将数据通过http/https协议发送到服务端上，并从服务端上用socket实现转发。具体流程：</p></div><p class="readmore"><a href="/2016/01/06/reGeorgSocksProxy-with-single-session-mode/">Read More</a></p></div><div class="post"><h1 class="post-title"><a href="/2016/01/03/WebLogicPasswordDecryptor-GUI/">WebLogic密码解密工具</a></h1><div class="post-meta">2016-01-03</div><div class="post-content"><p>一次内网渗透测试中遇到不少weblogic容器，而网上流传的weblogic密码解密方法、工具等都都觉得不太方便，事后抽空查资料了解weblogic的加密算法，并参考其中一份资料，做了一份GUI的解密工具，共享出来，有需要的带走。<br><img src="https://ws3.sinaimg.cn/large/006tNbRwly1fxw1pw5psij30fc08mta5.jpg" alt="WebLogicPasswordDecryptor-GUI"><br><a href="http://lab.imbeee.com/res/WebLogicPasswordDecryptor-GUI/WeblogicDecryptor-GUI_Release.rar" target="_blank" rel="noopener">WeblogicDecryptor-GUI_Release.rar</a></p></div><p class="readmore"><a href="/2016/01/03/WebLogicPasswordDecryptor-GUI/">Read More</a></p></div><div class="post"><h1 class="post-title"><a href="/2015/04/26/DUTCTF-2015-final/">DUTCTF-2015 正式比赛Writeup</a></h1><div class="post-meta">2015-04-26</div><div class="post-content"><p>题目不算难，web题基本上都是秒了的，misc题目涉及了一点硬件知识，挺新颖的。pwn题处理得不好，老出问题，后来了解到是他们那边管理人员沟通得不够，加上第一次举办CTF，没有经验，导致一些细节处理得不是很好。</p>
<p>另：本文已发表到360播报。</p>
<h3 id="web-10Pts"><a href="#web-10Pts" class="headerlink" title="web 10Pts"></a>web 10Pts</h3><p>DJ昨天才搭的网站，今天就被撸了，发现了一个一句话木马，密码是cmd，你能发现什么有用信息吗？ <a href="http://dl.dutsec.cn/web/web10/index.php" target="_blank" rel="noopener">http://dl.dutsec.cn/web/web10/index.php</a></p></div><p class="readmore"><a href="/2015/04/26/DUTCTF-2015-final/">Read More</a></p></div><nav class="page-navigator"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next</a></nav></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://www.imbeee.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Writeup/" style="font-size: 15px;">Writeup</a> <a href="/tags/Pentest/" style="font-size: 15px;">Pentest</a> <a href="/tags/Tool/" style="font-size: 15px;">Tool</a> <a href="/tags/Homelab/" style="font-size: 15px;">Homelab</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Embedded/" style="font-size: 15px;">Embedded</a> <a href="/tags/ARM/" style="font-size: 15px;">ARM</a> <a href="/tags/LKM/" style="font-size: 15px;">LKM</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://imbeee.github.io/" title="Github Pages备份" target="_blank">Github Pages备份</a><ul></ul><a href="https://ymr.me/" title="野蛮人の洞窟" target="_blank">野蛮人の洞窟</a><ul></ul><a href="http://bksec.net/" title="my5t3ry的blog" target="_blank">my5t3ry的blog</a><ul></ul><a href="https://www.blackh4t.org/" title="DarkRay's BLoG.!" target="_blank">DarkRay's BLoG.!</a><ul></ul><a href="https://www.iswin.org/" title="随风's Blog" target="_blank">随风's Blog</a><ul></ul><a href="http://www.00theway.org/" title="00theway's Blog" target="_blank">00theway's Blog</a><ul></ul><a href="https://threathunter.org/" title="ThreatHunter社区" target="_blank">ThreatHunter社区</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">Beeeの零碎事.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>